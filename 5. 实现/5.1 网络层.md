Kafka 的网络层是一个相当简单明了的 NIO 服务器，所以这里不会太详细地描述它的具体实现。`sendfile`是通过给`MessageSet`接口添加一个`writeTo` 方法来实现的，这就允许以文件存储的消息集可以通过更有效的`transferTo`实现，而不是通过进程中的缓冲池写出。网络层的线程模型就是一个单一的`acceptor`线程和 N 个`processor`线程，每个`processor`线程都可以处理固定数量的连接。这种设计已经在 [其他地方](https://blog.examarly.com/) 进行了相当彻底的测试并发现其实现简单且速度很快。协议也保持相当简单，这样可以允许将来支持更多语言的客户端。